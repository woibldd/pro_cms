{"version":3,"file":"pages/_id.js","sources":["webpack:///./api/server.js","webpack:///./pages/_id.vue?2a65","webpack:///./pages/_id.vue?8feb","webpack:///./pages/_id.vue?ae6b","webpack:///./pages/_id.vue","webpack:///./pages/_id.vue?8550","webpack:///./pages/_id.vue?ae5d"],"sourcesContent":["// import LRU from \"lru-cache\";\n// let CACHED = new LRU({\n//   max: 100, // 缓存队列长度\n//   maxAge: 1000 * 60 * 24 // 缓存时间 一个小时\n// });\nconst LANG = null\nfunction createURL(url, params) {\n  url += \"?\";\n  for (var item in params) {\n    url += `${item}=${params[item]}&`;\n  }\n  return url.substr(0, url.length - 1);\n}\nexport default {\n  articleDetail(ctx, data = {}) {\n    const { $axios,\n      app,\n      store,\n      route,\n      params,\n      query,\n      env,\n      isDev,\n      isHMR,\n      redirect,\n      error,\n      $config\n     } = ctx\n   \n   \n    let url = createURL(`/article/detail`, params);\n    // console.log(\"请求参数：\", JSON.stringify($config),JSON.stringify(params),JSON.stringify(query))\n    return $axios\n      .$get(url)\n      .then(result => {\n        // console.log(\"响应：\",result)\n        return result;\n      })\n      .catch(err => {\n        return { status: 1, msg: \"请求失败\" };\n      });\n  },\n\n\n  articleLang(ctx, data = {}) {\n    const { \n      $axios,\n      params,\n      query,\n      $config\n     } = ctx\n   \n    // console.log(\"请求参数：\", JSON.stringify($config),JSON.stringify(params),JSON.stringify(query))\n    let url = createURL(`/article/lang`, params);\n    return $axios\n      .$get(url)\n      .then(result => {\n        // console.log(\"响应：\",result)\n        return result;\n      })\n      .catch(err => {\n        return { status: 1, msg: \"请求失败\" };\n      });\n  },\n\n};\n","// Exports\nmodule.exports = {\n\n};\n","export * from \"-!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-0!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-1!../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-2!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./_id.vue?vue&type=style&index=0&id=bed537a6&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"article\"}},[_vm._ssrNode(\"<div class=\\\"header\\\" data-v-bed537a6><div class=\\\"title\\\" data-v-bed537a6>\"+_vm._ssrEscape(\"\\n      \"+_vm._s(_vm.info.title)+\"\\n    \")+\"</div> <div class=\\\"sub\\\" data-v-bed537a6><span data-v-bed537a6>\"+_vm._ssrEscape(_vm._s(_vm.source)+\":\")+\"</span> <span class=\\\"username\\\" data-v-bed537a6>\"+_vm._ssrEscape(_vm._s(_vm.info.user_name))+\"</span> <span data-v-bed537a6>\"+_vm._ssrEscape(_vm._s(_vm._f(\"filterDate\")(_vm.info.create_time)))+\"</span></div></div> \"+((_vm.info.content)?(\"<div class=\\\"content\\\" data-v-bed537a6>\"+(_vm._s(_vm.info.content))+\"</div>\"):(\"<div class=\\\"noData\\\" data-v-bed537a6>\\n       该文章不存在\\n  </div>\"))+\" \"),_c('van-image-preview',{attrs:{\"close-on-popstate\":\"\",\"closeable\":\"\",\"start-position\":_vm.current,\"images\":_vm.images},on:{\"change\":_vm.onChange,\"onclose\":_vm.onclose},model:{value:(_vm.showPreview),callback:function ($$v) {_vm.showPreview=$$v},expression:\"showPreview\"}})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport API from \"@/api/server.js\";\nexport default {\n  name: \"Detail\",\n  async asyncData(ctx) {\n   const [langR, detailR] =  await Promise.all([\n      API.articleLang(ctx),\n      API.articleDetail(ctx)\n    ])\n    const { status, data } = detailR;\n    const info =\n      String(data) == \"null\" || !data\n        ? {\n            title: \"该文章不存在\",\n          }\n        : data;\n    const { languages, means} =  langR.status ==0 ? langR.data : { languages:[],means:[] }\n    if(detailR.status == 0){\n        ctx.app.head.title = info.title;\n    }\n    return {\n        info,\n        languages,\n        means\n    };\n  },\n  computed:{\n      source(){\n        const { list } = this.languages.find(v=>v.zh=='来源') || {list:[]}\n        const { value }  = list.find(v=>v.key ==this.info.language) || {\n          key:\"en\",\n          value:\"source\"\n        }\n        return value\n      }\n  },\n  data() {\n    return {\n      showPreview: false,\n      images: [],\n      current: 0,\n      languages:[],\n      means:[],\n      info: {\n\n      }\n    };\n  },\n  async mounted() {\n    await this.$nextTick();\n    const self = this;\n    const imgs = document.getElementById(\"article\").getElementsByTagName(\"img\");\n    this.images = Array.from(imgs)\n      .map((v, index) => {\n        v.setAttribute(\"show_index\", index);\n        v.onclick = function () {\n          self.showPreview = true;\n          self.current = Number(this.getAttribute(\"show_index\") || 0);\n        };\n        return v.getAttribute(\"src\") || v.getAttribute(\"href\");\n      })\n      .filter((v) => v);\n  },\n  methods: {\n    onChange() {},\n    onclose() {\n      console.log(arguments);\n    },\n  },\n\n  filters: {\n    filterDate(create_time) {\n      function isZero(m) {\n        return m < 10 ? \"0\" + m : m;\n      }\n      //时间戳是整数，否则要parseInt转换\n      var time = new Date(create_time|| new Date().getTime()); // 需要使用Date格式进行日期转化，若是时间戳、字符串时间，需要通过new Date(..)转化\n      var y = time.getFullYear();\n      var m = time.getMonth() + 1;\n      var d = time.getDate();\n      var h = time.getHours();\n      var mm = time.getMinutes();\n      return (\n        y +\n        \"-\" +\n        isZero(m) +\n        \"-\" +\n        isZero(d) +\n        \" \" +\n        isZero(h) +\n        \":\" +\n        isZero(mm)\n      );\n    },\n  },\n};\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./_id.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./_id.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./_id.vue?vue&type=template&id=bed537a6&scoped=true&\"\nimport script from \"./_id.vue?vue&type=script&lang=js&\"\nexport * from \"./_id.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./_id.vue?vue&type=style&index=0&id=bed537a6&lang=scss&scoped=true&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"bed537a6\",\n  \"1758bdbf\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA;AAeA;AACA;AACA;AAGA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAJA;AACA;AAOA;AACA;AAGA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAnDA;;;;;;;ACbA;AACA;AACA;AACA;;;;;;;;;ACHA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AACA;AACA;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AAIA;AAAA;AAAA;AAAA;AACA;AAGA;AADA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AACA;AATA;AACA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAUA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAWA;AACA;AAxBA;AApEA;;AC9BA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}